palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_dots(TopCities,col = 'red')
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_dots(TopCities,col = 'red', size = 1)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_dots(TopCities$city,col = 'red', size = 1)
TopCities
plot(TopCities)
plot(TopCities)
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(TopCities) +
tm_dots(col = 'red', size = 1)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(TopCities) +
tm_dots(col = 'red', label(city)  , size = 1)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(TopCities) +
tm_dots(col = 'red', label(cities)  , size = 1)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(TopCities) +
tm_dots(col = 'red', label('cities')  , size = 1)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(TopCities) +
tm_dots(col = 'red', legend.z = cities  , size = 1)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(TopCities) +
tm_dots(col = 'red', legend.z = city  , size = 1)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(TopCities) +
tm_dots(col = 'red', legend.z = 'city'  , size = 1)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(TopCities) +
tm_dots(col = 'red', legend.z = 'city'  , size = 0.3)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(TopCities) +
tm_dots(col = 'white', legend.z = 'city'  , size = 0.3)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(TopCities) +
tm_dots(col = 'blue', legend.z = 'city'  , size = 0.3)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(TopCities) +
tm_dots(col = 'blue', legend.z = 'city'  , size = 0.3) +
tm_text('city')
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(TopCities) +
tm_dots(col = 'blue', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.3)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(TopCities) +
tm_dots(col = 'blue', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.5)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(TopCities) +
tm_dots(col = 'blue', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8)
plot(top_n(TopCities, population))
plot(top_n(TopCities,TopCities$population))
plot(TopCities[,:5])
plot(TopCities[:5])
plot(TopCities[5])
plot(slice_head(TopCities))
plot(slice_head(TopCities))
plot(slice_head(TopCities, 5))
plot(slice_head(TopCities, n=5))
plot(slice_head(TopCities, n=10))
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(Tslice_head(TopCities, n=10)) +
tm_dots(col = 'blue', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(slice_head(TopCities, n=10)) +
tm_dots(col = 'blue', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(slice_head(TopCities, n=10)) +
tm_dots(col = 'blue', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8, ymod = 1)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(slice_head(TopCities, n=10)) +
tm_dots(col = 'blue', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8, ymod = 0.7)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(slice_head(TopCities, n=10)) +
tm_dots(col = 'gery', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8, ymod = 0.7)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(slice_head(TopCities, n=10)) +
tm_dots(col = 'grey', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8, ymod = 0.7)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(slice_head(TopCities, n=15)) +
tm_dots(col = 'grey', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8, ymod = 0.7)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(slice_head(TopCities, n=10)) +
tm_dots(col = 'grey', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8, ymod = 0.7)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(slice_head(TopCities, n=w0)) +
tm_dots(col = 'grey', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8, ymod = 0.7)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(slice_head(TopCities, n=20)) +
tm_dots(col = 'grey', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8, ymod = 0.7)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(slice_head(TopCities, n=15)) +
tm_dots(col = 'grey', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8, ymod = 0.7)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(slice_head(TopCities, n=1-10)) +
tm_dots(col = 'grey', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8, ymod = 0.7)
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(slice_head(TopCities, n=10)) +
tm_dots(col = 'grey', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8, ymod = 0.7)
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score_LQ",
style="jenks",
palette="RdBu",
legend.hist = TRUE,
midpoint=NA,
popup.vars=c("NAME_2", "all_score_LQ"),
title="Language Score")
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score_LQ",
style="jenks",
palette="RdBu",
legend.hist = TRUE,
midpoint=NA,
popup.vars=c("NAME_2", "all_score_LQ"),
title="Language Score") +
tm_shape(slice_head(TopCities, n=10)) +
tm_dots(col = 'grey', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8, ymod = 0.7)
import(spGini)
library(spGini)
library('spGini')
#### GINI ??
install.packages('spGini')
#### GINI ??
#install.packages('spGini')
library('spGini')
#### GINI ??
#install.packages('spGini')
library(spGini)
#### GINI ??
#install.packages('spGini')
library(lctools)
#### GINI ??
#install.packages('spGini')
install.packages("lctools")
HungaryLanugageAll$geometry.x
c(HungaryLanugageAll$geometry.x, HungaryLanugageAll$geometry.y)
lctools::spGini(Coordsc(HungaryLanugageAll$geometry.x, HungaryLanugageAll$geometry.y),x =HungaryLanugageAll$all_score, Bandwidth = 3, WType = 'Binary' )
lctools::spGini(Coords=c(HungaryLanugageAll$geometry.x, HungaryLanugageAll$geometry.y),x =HungaryLanugageAll$all_score, Bandwidth = 3, WType = 'Binary' )
lctools::spGini(Coords=c(HungaryLanugageAll$geometry.x, HungaryLanugageAll$geometry.y),x =HungaryLanugageAll$all_score, Bandwidth = 3, WType = 'Binary' )
lctools::spGini(Coords=c(HungaryLanugageAll$geometry.x, HungaryLanugageAll$geometry.y),x =HungaryLanugageAll$all_score, Bandwidth = 4, WType = 'Binary' )
lctools::spGini(Coords=c(HungaryLanugageAll$geometry.x, HungaryLanugageAll$geometry.y),x =HungaryLanugageAll$all_score, Bandwidth = 10, WType = 'Binary' )
lctools::spGini(Coords=c(HungaryLanugageAll$geometry.x, HungaryLanugageAll$geometry.y),x =HungaryLanugageAll$all_score, Bandwidth = 12, WType = 'Binary' )
lctools::spGini(Coords=c(HungaryLanugageAll$geometry.x, HungaryLanugageAll$geometry.y),x =HungaryLanugageAll$all_score, Bandwidth = 1, WType = 'Binary' )
lctools::spGini(Coords=cbind(HungaryLanugageAll$geometry.x, HungaryLanugageAll$geometry.y),x =HungaryLanugageAll$all_score, Bandwidth = 1, WType = 'Binary' )
coordsW
coordsW[1]
lctools::spGini(Coords=coordsW, HungaryLanugageAll$geometry.y),x =HungaryLanugageAll$all_score, Bandwidth = 1, WType = 'Binary' )
lctools::spGini(Coords=coordsW, x =HungaryLanugageAll$all_score, Bandwidth = 1, WType = 'Binary' )
HungaryLanugageAll %>%
centroid(.)
HungaryLanugageAll %>%
centroid()
HungaryLanugageAll %>%
st_centroid()
coordsC = HungaryLanugageAll %>%
st_centroid()
coordsC <- HungaryLanugageAll %>%
st_centroid()
coordsC
coordsC$geometry.x
coordsC$CC_2
coordsC$geometry
st_centroid(HungaryLanugageAll)
plot(coordsC)
coordsC$geometry.x
coordsC$geometry.y
coordsW$geometry.X
coordsW$geometry.x
coordsW
coordsW[1]
lctools::spGini(Coords=coordsW, x=HungaryLanugageAll$all_score, Bandwidth = 12, WType = 'Binary' )
HungaryLanugageAll <- HungaryLanugageAll %>%
mutate(density_G = as.numeric(Gi_FL_score_Local_Density))
Gi_FL_score_Local_Density <-  HungaryLanugageAll %>%
pull(all_score) %>%
as.vector()%>%
localG(., HungaryLanugageAll.lw)
HungaryLanugageAll <- HungaryLanugageAll %>%
mutate(density_G = as.numeric(Gi_FL_score_Local_Density))
breaks1<-c(-1000,-2.58,-1.96,-1.65,1.65,1.96,2.58,1000)
tm_shape(HungaryLanugageAll) +
tm_polygons("density_G",
style="fixed",
breaks=breaks1,
midpoint=NA,
title="Gi*, Blue Plaques in London")
tm_shape(HungaryLanugageAll) +
tm_polygons("density_G",
style="fixed",
breaks=breaks1,
midpoint=NA,
title="Gi*, FL capabilities Hot-Cold Spot in Hungary")
tm_shape(HungaryLanugageAll) +
tm_polygons("density_G",
palette="ReBu",
style="fixed",
breaks=breaks1,
midpoint=NA,
title="Gi*, FL capabilities Hot-Cold Spot in Hungary")
tm_shape(HungaryLanugageAll) +
tm_polygons("density_G",
palette="RdBu",
style="fixed",
breaks=breaks1,
midpoint=NA,
title="Gi*, FL capabilities Hot-Cold Spot in Hungary")
tm_shape(HungaryLanugageAll) +
tm_polygons("density_G",
palette="-RdBu",
style="fixed",
breaks=breaks1,
midpoint=NA,
title="Gi*, FL capabilities Hot-Cold Spot in Hungary")
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(slice_head(TopCities, n=10)) +
tm_dots(col = 'grey', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8, ymod = 0.7)
tm_shape(HungaryLanugageAll) +
tm_polygons("density_G",
palette="-RdBu",
style="fixed",
breaks=breaks1,
midpoint=NA,
title="Gi*, FL capabilities Hot-Cold Spot in Hungary")
## Visualise - English Language Map
tm_shape(HungarySchoolsLanguage) +
tm_polygons("eng_score",
style="jenks",
palette="PuOr",
midpoint=NA,
popup.vars=c("name_2", "eng_score"),
title="English Language Score")
### MAP OF THE LANGUAGE TOTAL SCORE
tm_shape(HungaryLanugageAll) +
tm_polygons("all_score",
style="jenks",
palette="BuPu",
midpoint=NA,
border.alpha = 0,
popup.vars=c("NAME_2", "all_score"),
title="Language Score") +
tm_shape(slice_head(TopCities, n=10)) +
tm_dots(col = 'grey', legend.z = 'city'  , size = 0.3) +
tm_text('city', size=0.8, ymod = 0.7)
tm_shape(HungaryLanugageAll) +
tm_polygons("density_G",
palette="-RdBu",
style="fixed",
breaks=breaks1,
midpoint=NA,
title="Gi*, FL capabilities Hot-Cold Spot in Hungary")
